<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>POST → GET Converter (SSB PXWeb)</title>
  <meta name="description" content="Konverter PXWeb POST-body (SSB) til en GET-URL med valueCodes[Dim]=verdier." />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main>
    <header>
      <h1>POST → GET (SSB PXWeb)</h1>
      <p class="lead">Lim inn en PXWeb POST-body eller cURL med <code>-d</code>. Appen oppdager PXWeb automatisk og lager riktig GET-URL.</p>
    </header>

    <section class="card">
      <label for="baseUrl">Base-URL (inkludér gjerne <code>?lang=no</code>)</label>
      <input id="baseUrl" placeholder="https://data.ssb.no/api/pxwebapi/v2/tables/09429/data?lang=no" />

      <div class="hint">Eksempel: <code>https://data.ssb.no/api/pxwebapi/v2/tables/09429/data?lang=no</code></div>

      <label for="postBody">POST-body eller cURL</label>
      <textarea id="postBody" rows="14" placeholder='Lim inn PXWeb POST som JSON, f.eks.:
{
  "query": [
    {
      "code": "Region",
      "selection": { "filter": "agg_single:KommGjeldende", "values": ["3101","3103"] }
    },
    { "code": "Nivaa", "selection": { "filter": "item", "values": ["00","01","02a","11","03a","04a","09a"] } },
    { "code": "ContentsCode", "selection": { "filter": "item", "values": ["Personer"] } },
    { "code": "Tid", "selection": { "filter": "item", "values": ["2023","2024"] } }
  ],
  "response": { "format": "json-stat2" }
}

Eller en cURL:
curl -X POST https://data.ssb.no/api/pxwebapi/v2/tables/09429/data?lang=no -H "content-type: application/json" -d "{ \"query\": [ ... ] }"
'></textarea>

      <div class="row">
        <button id="btn">Konverter</button>
        <button id="clearBtn" class="ghost">Tøm</button>
      </div>

      <div id="mode" class="mode">Modus: (ukjent)</div>

      <label for="output">GET-URL</label>
      <input id="output" readonly />
      <div class="row">
        <button id="copyBtn">Kopier</button>
        <a id="openBtn" class="ghost" href="#" target="_blank" rel="noopener">Åpne i ny fane</a>
      </div>

      <details class="tip">
        <summary>Om konverteringen</summary>
        <ul>
          <li>Oppdager PXWeb-JSON (feltet <code>query</code> er en array med <code>code</code> + <code>selection.values</code>).</li>
          <li>Bygger parametere som <code>valueCodes[Region]=3101,3103</code>, <code>valueCodes[Nivaa]=...</code> i samme rekkefølge.</li>
          <li><code>selection.filter</code> beholdes ikke i GET – bare <code>values</code> brukes.</li>
          <li>Andre formater (ren form-encoded/vanlig JSON) støttes fortsatt som fallback.</li>
        </ul>
      </details>
    </section>

    <footer>
      <p>Statisk app – ingen data sendes til server. © 2025 – MIT</p>
    </footer>
  </main>

  <script src="main.js"></script>
</body>
</html>
